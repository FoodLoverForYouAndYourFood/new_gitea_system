# Telegram Instant View

Instant View позволяет читать статьи прямо в Telegram без загрузки сайта. Ниже — готовый чек-лист для подключения нашего портала.

## 1. Подготовьте домен

- Подключите доменное имя к серверу и дождитесь, пока DNS обновятся.
- В `mkdocs.yml` уже прописан `site_url`. Обновите его на реальный домен и перезапустите автодеплой (таймер подхватит изменения автоматически).

## 2. Верифицируйте домен в Instant View

1. Откройте [instantview.telegram.org](https://instantview.telegram.org/my/).
2. Авторизуйтесь и нажмите **Add Domain**.
3. Укажите домен и разместите любой URL из сайта (подойдёт главная страница).
4. Telegram выдаст уникальное значение для мета-тега `telegram:channel`.  
   Оно уже подхватывается из `mkdocs.yml` (`extra.telegram.channel`).  
   Если Telegram просит другое значение — обновите его в конфиге:
   ```yaml
   extra:
     telegram:
       channel: "@analyst_exe"     # замените на требуемый тег
   ```
5. После пуша изменений автодеплой внесёт мета-тег в `<head>` (через `overrides/partials/head.html`).

## 3. Создайте шаблон

1. В Instant View выберите свой домен и нажмите **Create Template**.
2. Введите URL любой статьи (например `https://<домен>/mkdocs-sa-library/01-basics/intro/`).
3. Вставьте шаблон (базовый пример):
   ```text
   @title: //header//h1
   @description: //meta[@name="description"]/@content
   @cover: //meta[@property="og:image"]/@content
   @author: '@analyst_exe'

   @body: //article | //main | //div[@class="md-content"]
   ```
   - При необходимости уточните XPath под конкретную статью.
   - Используйте панель предпросмотра и кнопку `Test`, чтобы убедиться, что все страницы корректно разбираются.
4. Нажмите **Save** и активируйте шаблон.

## 4. Автоматизация

- После сохранения шаблон будет применяться ко всем ссылкам, ведущим на ваш домен.
- При изменении структуры страниц обновите шаблон и снова сохраните его в редакторе Instant View.

## Полезные советы

- Добавляйте в статьи обложки (`extra/` или ссылки на внешние изображения) — Instant View подхватывает `og:image`.
- Если в шаблоне используется несколько вариантов структуры, применяйте операторы `|` и условия `if`.
- Проверяйте статьи командой `/iv <url>` в Telegram.
